apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: qdrantcollectiontemplates.qdrant.operator
  labels:
    app: qdrant-operator
spec:
  group: qdrant.operator
  names:
    plural: qdrantcollectiontemplates
    singular: qdrantcollectiontemplate
    kind: QdrantCollectionTemplate
    shortNames: ['qct', 'qctemplate']
  scope: Cluster
  versions:
    - name: v1alpha1
      served: true
      storage: true
      subresources:
        status: {}
      schema:
        openAPIV3Schema:
          description: 'A reusable template for Qdrant collections'
          type: object
          required: ['kind', 'apiVersion', 'spec']
          properties:
            apiVersion:
              type: string
            kind:
              type: string
            metadata:
              type: object
            spec:
              description: 'Template specification for collections'
              type: object
              required: ['name']
              properties:
                name:
                  description: 'Template name (used in API: template: "name")'
                  type: string
                  pattern: '^[a-z0-9-]+$'
                shards:
                  description: 'Number of shards'
                  type: integer
                  minimum: 1
                  default: 1
                replicationFactor:
                  description: 'Replication factor'
                  type: integer
                  minimum: 1
                  default: 1
                onDisk:
                  description: 'Store vectors on disk'
                  type: boolean
                  default: true
                vectors:
                  description: 'Vector configuration'
                  type: object
                  properties:
                    size:
                      type: integer
                      minimum: 1
                    distance:
                      type: string
                      enum: ['Cosine', 'Euclid', 'Dot']
                    quantization:
                      type: object
                      properties:
                        scalar:
                          type: object
                          properties:
                            type:
                              type: string
                              enum: ['int8']
                        product:
                          type: object
                          properties:
                            compression:
                              type: string
                              enum: ['x4', 'x8', 'x16', 'x32', 'x64']
                backup:
                  description: 'Backup configuration'
                  type: object
                  properties:
                    enabled:
                      type: boolean
                      default: false
                    schedule:
                      description: 'Cron schedule for backups'
                      type: string
                    retentionCount:
                      description: 'Number of backups to retain'
                      type: integer
                      minimum: 1
                      default: 7
            status:
              type: object
              properties:
                usageCount:
                  description: 'Number of collections using this template'
                  type: integer
                lastUsed:
                  description: 'Timestamp of last usage'
                  type: string
                  format: date-time

